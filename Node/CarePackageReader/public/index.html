<script src="https://cdnjs.cloudflare.com/ajax/libs/tone/13.8.17/Tone.js"
    integrity="sha256-r7tIh/MofTXMny46s6rXWvSDSpz4XpwopzcOvSJD8VE=" crossorigin="anonymous"></script>
<script>

    (function () {

        console.log("Setup");

        // Create WebSocket connection.
        const socket = new WebSocket('ws://localhost:8080');

        // Connection opened
        socket.addEventListener('open', function (event) {
            socket.send('Hello Server!');
        });

        // Listen for messages
        socket.addEventListener('message', function (event) {
            console.log('Message from server ', event.data);


            switch (event.data) {
                case "1778646020":
                    synth.triggerAttackRelease("C4", "4n");
                    showPlace("school");
                    break;
                case "1778530052":
                    synth.triggerAttackRelease("E4", "4n");
                    showPlace("hospital");
                    break;
                case "1778588676":
                    synth.triggerAttackRelease("G4", "4n");
                    showPlace("airport");
                    break;
                case "1778588420":
                    synth.triggerAttackRelease("C5", "4n");
                    showPlace("stadium");
                    break;
            }

        });

        //

        document.addEventListener('keydown', (event) => {
            const keyName = event.key;

            switch (event.key) {
                case "1":
                    showPlace("school");
                    synth.triggerAttackRelease("C4", "4n");
                    break;
                case "2":
                    showPlace("hospital");
                    synth.triggerAttackRelease("E4", "4n");
                    break;
                case "3":
                    showPlace("airport");
                    synth.triggerAttackRelease("G4", "4n");
                    break;
                case "4":
                    showPlace("stadium");
                    synth.triggerAttackRelease("C5", "4n");
                    break;
            }

        }, false);

        //

        var synth = new Tone.Synth().toMaster();
        let lastDiv;

        function showPlace(place) {
            if (lastDiv != null) lastDiv.style.display = "none";

            let div = document.getElementById(place);
            div.style.display = "initial";

            lastDiv = div;

            setTimeout(() => {
                if (lastDiv != null) lastDiv.style.display = "none";
            }, 1000)
        }

    })();

</script>

<style>
    .place {
        display: none;
    }
</style>

<div id="school" class="place"><img src="images/school.svg"></div>
<div id="stadium" class="place"><img src="images/stadium.svg"></div>
<div id="hospital" class="place"><img src="images/hospital.svg"></div>
<div id="airport" class="place"><img src="images/airport.svg"></div>